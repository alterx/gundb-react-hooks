!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],n):n(e.gundbReactHooks={},e.react)}(this,function(e,n){var r=function(e,n,r){try{return Promise.resolve(n&&r?r.encrypt(e,n):e)}catch(e){return Promise.reject(e)}},t=function(e,n,r){try{return Promise.resolve(n&&r?r.decrypt(e,n):e)}catch(e){return Promise.reject(e)}},u=function(e,n){void 0===n&&(n=100);var r,t=[];return function(u){return t.push(u),r||(r=setTimeout(function(){var n=t.reduce(function(e,n){return e[n.id]=n.data,e},{});e(n),t=[],r=null},n)),function(){clearTimeout(r),t=[],r=null}}},o=function(e,n){var r,t=n.data;switch(n.type){case"add":return Object.assign({},e,t);case"update":return Object.assign({},e,((r={})[t.nodeID]=t,r));case"remove":return delete e[t],Object.assign({},e);default:throw new Error}},c=function(){var e=n.useRef(!1);return n.useEffect(function(){return e.current=!0,function(){return e.current=!1}},[]),e},i=function(e,r){var t=n.useReducer(e,r),u=t[0],o=t[1],i=c();return[u,function(e){i.current&&o(e)}]},s=function(e){var r=n.useState(null),t=r[0];return t||(0,r[1])(e.user()),[t]};e.encryptData=r,e.decryptData=t,e.debouncedUpdates=u,e.reducer=o,e.useIsMounted=c,e.useSafeReducer=i,e.useGun=function(e,r){return[n.useState(e({peers:r}))[0]]},e.useGunNamespace=s,e.useGunKeyAuth=function(e,r,t){void 0===t&&(t=!0);var u=s(e)[0],o=n.useState(!1),c=o[0],i=o[1];return e.on("auth",function(){i(!0)}),n.useEffect(function(){u&&!u.is&&r&&t&&u.auth(r)},[t,u,r]),[u,c]},e.useGunKeys=function(e,r){var t=n.useState(r),u=t[0],o=t[1];return u||function(){try{Promise.resolve(e.pair()).then(function(e){o(e)})}catch(e){return Promise.reject(e)}}(),[u,o]},e.useGunState=function(e,s){void 0===s&&(s={appKeys:"",sea:null,interval:100,useOpen:!1});var a=s.appKeys,f=s.sea,d=s.interval;void 0===d&&(d=100);var l=s.useOpen;void 0===l&&(l=!1);var p=n.useState(e)[0],v=i(o,{}),m=v[0],h=v[1],P=n.useRef(null),y=c();return n.useEffect(function(){var e=[];if(y.current){var n=u(function(e){h({type:"add",data:e})},d),r=function(r,u,o,c){try{return Promise.resolve(t(r,a,f)).then(function(r){Object.keys(r).forEach(function(t){var u=n({id:t,data:r[t]});e.push(u)}),P.current||(P.current=c)})}catch(e){return Promise.reject(e)}};if(l){if(!p.open)throw new Error("Please include gun/lib/open.");p.open(r)}else p.on(r)}return function(){P.current&&P.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),{fields:m,put:function(e){try{return Promise.resolve(r(e,a,f)).then(function(e){return Promise.resolve(new Promise(function(n,r){return p.put(e,function(e){return e.ok?n():r(e.err)})})).then(function(){})})}catch(e){return Promise.reject(e)}},remove:function(e){try{return Promise.resolve(new Promise(function(e,n){return p.put(null,function(r){return r.ok?e():n(r.err)})})).then(function(){h({type:"remove",data:e})})}catch(e){return Promise.reject(e)}}}},e.useGunCollectionState=function(e,s){void 0===s&&(s={appKeys:"",sea:null,interval:100,useOpen:!1});var a=s.appKeys,f=s.sea,d=s.interval;void 0===d&&(d=100);var l=s.useOpen,p=n.useState(e)[0],v=i(o,{}),m=v[0],h=v[1],P=n.useRef(null),y=c();return n.useEffect(function(){var e=[];if(y.current){var n=u(function(e){h({type:"add",data:e})},d),r=function(r,u,o,c){try{return Promise.resolve(t(r,a,f)).then(function(r){if(r){var t=n({id:u,data:Object.assign({},r,{nodeID:u})});e.push(t)}P.current||(P.current=c)})}catch(e){return Promise.reject(e)}};if(l){if(!p.open)throw new Error("Please include gun/lib/open.");p.map().open(r)}else p.map().on(r)}return function(){P.current&&P.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),{collection:m,addToSet:function(e,n){try{return Promise.resolve(r(e,a,f)).then(function(e){var r=n?Promise.resolve(new Promise(function(r,t){return p.get(n).put(e,function(e){return e.ok?r():t(e.err)})})).then(function(){}):Promise.resolve(new Promise(function(n,r){return p.set(e,function(e){return e.ok?n():r(e.err)})})).then(function(){});if(r&&r.then)return r.then(function(){})})}catch(e){return Promise.reject(e)}},updateInSet:function(e,n){try{return Promise.resolve(r(n,a,f)).then(function(r){return Promise.resolve(new Promise(function(n,t){return p.get(e).put(r,function(e){return e.ok?n():t(e.err)})})).then(function(){h({type:"update",data:Object.assign({},{nodeID:e},n)})})})}catch(e){return Promise.reject(e)}},removeFromSet:function(e){try{return Promise.resolve(new Promise(function(n,r){return p.get(e).put(null,function(e){return e.ok?n():r(e.err)})})).then(function(){})}catch(e){return Promise.reject(e)}}}}});
//# sourceMappingURL=index.umd.js.map
