!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],r):r((e=e||self).gundbReactHooks={},e.react)}(this,function(e,r){function n(){return(n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}var t=function(e,r,n){try{return Promise.resolve(r&&n?n.encrypt(e,r):e)}catch(e){return Promise.reject(e)}},u=function(e,r,n){try{return Promise.resolve(r&&n?n.decrypt(e,r):e)}catch(e){return Promise.reject(e)}},o=function(e,r){void 0===r&&(r=100);var n,t=[];return function(u){return t.push(u),n||(n=setTimeout(function(){var r=t.reduce(function(e,r){return e[r.id]=r.data,e},{});e(r),t=[],n=null},r)),function(){clearTimeout(n),t=[],n=null}}},c=function(e,r){var t,u=r.data;switch(r.type){case"add":return n({},e,u);case"update":return n({},e,((t={})[u.nodeID]=u,t));case"remove":return delete e[u],n({},e);default:throw new Error}},i=function(){var e=r.useRef(!1);return r.useEffect(function(){return e.current=!0,function(){return e.current=!1}},[]),e},s=function(e,n){var t=r.useReducer(e,n),u=t[0],o=t[1],c=i();return[u,function(e){c.current&&o(e)}]},f=function(e){var n=r.useState(null),t=n[0];return t||(0,n[1])(e.user()),[t]};e.debouncedUpdates=o,e.decryptData=u,e.encryptData=t,e.reducer=c,e.useGun=function(e,n){return[r.useState(e({peers:n}))[0]]},e.useGunCollectionState=function(e,f){void 0===f&&(f={appKeys:"",sea:null,interval:100,useOpen:!1});var a=f.appKeys,l=f.sea,p=f.interval,d=void 0===p?100:p,v=f.useOpen,h=r.useState(e)[0],m=s(c,{}),P=m[0],y=m[1],j=r.useRef(null),w=i();return r.useEffect(function(){var e=[];if(w.current){var r=o(function(e){y({type:"add",data:e})},d),t=function(t,o,c,i){try{return Promise.resolve(u(t,a,l)).then(function(t){if(t){var u=r({id:o,data:n({},t,{nodeID:o})});e.push(u)}j.current||(j.current=i)})}catch(e){return Promise.reject(e)}};if(v){if(!h.open)throw new Error("Please include gun/lib/open.");h.map().open(t)}else h.map().on(t)}return function(){j.current&&j.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),{collection:P,addToSet:function(e,r){try{return Promise.resolve(t(e,a,l)).then(function(e){var n=r?Promise.resolve(new Promise(function(n,t){return h.get(r).put(e,function(e){return e.err?t(e.err):n()})})).then(function(){}):Promise.resolve(new Promise(function(r,n){return h.set(e,function(e){return e.err?n(e.err):r()})})).then(function(){});if(n&&n.then)return n.then(function(){})})}catch(e){return Promise.reject(e)}},updateInSet:function(e,r){try{return Promise.resolve(t(r,a,l)).then(function(t){return Promise.resolve(new Promise(function(r,n){return h.get(e).put(t,function(e){return e.err?n(e.err):r()})})).then(function(){y({type:"update",data:n({nodeID:e},r)})})})}catch(e){return Promise.reject(e)}},removeFromSet:function(e){try{return Promise.resolve(new Promise(function(r,n){return h.get(e).put(null,function(e){return e.err?n(e.err):r()})})).then(function(){})}catch(e){return Promise.reject(e)}}}},e.useGunKeyAuth=function(e,n,t){void 0===t&&(t=!0);var u=f(e)[0],o=r.useState(!1),c=o[0],i=o[1];return e.on("auth",function(){i(!0)}),r.useEffect(function(){u&&!u.is&&n&&t&&u.auth(n)},[t,u,n]),[u,c]},e.useGunKeys=function(e,n){var t=r.useState(n),u=t[0],o=t[1];return u||function(){try{Promise.resolve(e.pair()).then(function(e){o(e)})}catch(e){return Promise.reject(e)}}(),[u,o]},e.useGunNamespace=f,e.useGunState=function(e,n){void 0===n&&(n={appKeys:"",sea:null,interval:100,useOpen:!1});var f=n.appKeys,a=n.sea,l=n.interval,p=void 0===l?100:l,d=n.useOpen,v=void 0!==d&&d,h=r.useState(e)[0],m=s(c,{}),P=m[0],y=m[1],j=r.useRef(null),w=i();return r.useEffect(function(){var e=[];if(w.current){var r=o(function(e){y({type:"add",data:e})},p),n=function(n,t,o,c){try{return Promise.resolve(u(n,f,a)).then(function(n){Object.keys(n).forEach(function(t){var u=r({id:t,data:n[t]});e.push(u)}),j.current||(j.current=c)})}catch(e){return Promise.reject(e)}};if(v){if(!h.open)throw new Error("Please include gun/lib/open.");h.open(n)}else h.on(n)}return function(){j.current&&j.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),{fields:P,put:function(e){try{return Promise.resolve(t(e,f,a)).then(function(e){return Promise.resolve(new Promise(function(r,n){return h.put(e,function(e){return e.err?n(e.err):r()})})).then(function(){})})}catch(e){return Promise.reject(e)}},remove:function(e){try{return Promise.resolve(new Promise(function(e,r){return h.put(null,function(n){return n.err?r(n.err):e()})})).then(function(){y({type:"remove",data:e})})}catch(e){return Promise.reject(e)}}}},e.useIsMounted=i,e.useSafeReducer=s});
//# sourceMappingURL=index.umd.js.map
