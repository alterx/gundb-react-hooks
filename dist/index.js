var e=require("react"),r=function(e,r,t){try{return Promise.resolve(r&&t?t.encrypt(e,r):e)}catch(e){return Promise.reject(e)}},t=function(e,r,t){try{return Promise.resolve(r&&t?t.decrypt(e,r):e)}catch(e){return Promise.reject(e)}},n=function(e,r){void 0===r&&(r=100);var t,n=[];return function(u){return n.push(u),t||(t=setTimeout(function(){var r=n.reduce(function(e,r){return e[r.id]=r.data,e},{});e(r),n=[],t=null},r)),function(){clearTimeout(t),n=[],t=null}}},u=function(e,r){var t,n=r.data;switch(r.type){case"add":return Object.assign({},e,n);case"update":return Object.assign({},e,((t={})[n.nodeID]=n,t));case"remove":return delete e[n],Object.assign({},e);default:throw new Error}},o=function(){var r=e.useRef(!1);return e.useEffect(function(){return r.current=!0,function(){return r.current=!1}},[]),r},c=function(r,t){var n=e.useReducer(r,t),u=n[0],c=n[1],i=o();return[u,function(e){i.current&&c(e)}]},i=function(r){var t=e.useState(null),n=t[0];return n||(0,t[1])(r.user()),[n]};exports.encryptData=r,exports.decryptData=t,exports.debouncedUpdates=n,exports.reducer=u,exports.useIsMounted=o,exports.useSafeReducer=c,exports.useGun=function(r,t){return[e.useState(r({peers:t}))[0]]},exports.useGunNamespace=i,exports.useGunKeyAuth=function(r,t,n){void 0===n&&(n=!0);var u=i(r)[0],o=e.useState(!1),c=o[0],s=o[1];return r.on("auth",function(){s(!0)}),e.useEffect(function(){u&&!u.is&&t&&n&&u.auth(t)},[n,u,t]),[u,c]},exports.useGunKeys=function(r,t){var n=e.useState(t),u=n[0],o=n[1];return u||function(){try{Promise.resolve(r.pair()).then(function(e){o(e)})}catch(e){return Promise.reject(e)}}(),[u,o]},exports.useGunState=function(i,s){void 0===s&&(s={appKeys:"",sea:null,interval:100,useOpen:!1});var a=s.appKeys,f=s.sea,p=s.interval;void 0===p&&(p=100);var l=s.useOpen;void 0===l&&(l=!1);var v=e.useState(i)[0],d=c(u,{}),m=d[0],h=d[1],P=e.useRef(null),y=o();return e.useEffect(function(){var e=[];if(y.current){var r=n(function(e){h({type:"add",data:e})},p),u=function(n,u,o,c){try{return Promise.resolve(t(n,a,f)).then(function(t){Object.keys(t).forEach(function(n){var u=r({id:n,data:t[n]});e.push(u)}),P.current||(P.current=c)})}catch(e){return Promise.reject(e)}};if(l){if(!v.open)throw new Error("Please include gun/lib/open.");v.open(u)}else v.on(u)}return function(){P.current&&P.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),{fields:m,put:function(e){try{return Promise.resolve(r(e,a,f)).then(function(e){return Promise.resolve(new Promise(function(r,t){return v.put(e,function(e){return e.err?t(e.err):r()})})).then(function(){})})}catch(e){return Promise.reject(e)}},remove:function(e){try{return Promise.resolve(new Promise(function(e,r){return v.put(null,function(t){return t.err?r(t.err):e()})})).then(function(){h({type:"remove",data:e})})}catch(e){return Promise.reject(e)}}}},exports.useGunCollectionState=function(i,s){void 0===s&&(s={appKeys:"",sea:null,interval:100,useOpen:!1});var a=s.appKeys,f=s.sea,p=s.interval;void 0===p&&(p=100);var l=s.useOpen,v=e.useState(i)[0],d=c(u,{}),m=d[0],h=d[1],P=e.useRef(null),y=o();return e.useEffect(function(){var e=[];if(y.current){var r=n(function(e){h({type:"add",data:e})},p),u=function(n,u,o,c){try{return Promise.resolve(t(n,a,f)).then(function(t){if(t){var n=r({id:u,data:Object.assign({},t,{nodeID:u})});e.push(n)}P.current||(P.current=c)})}catch(e){return Promise.reject(e)}};if(l){if(!v.open)throw new Error("Please include gun/lib/open.");v.map().open(u)}else v.map().on(u)}return function(){P.current&&P.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),{collection:m,addToSet:function(e,t){try{return Promise.resolve(r(e,a,f)).then(function(e){var r=t?Promise.resolve(new Promise(function(r,n){return v.get(t).put(e,function(e){return e.err?n(e.err):r()})})).then(function(){}):Promise.resolve(new Promise(function(r,t){return v.set(e,function(e){return e.err?t(e.err):r()})})).then(function(){});if(r&&r.then)return r.then(function(){})})}catch(e){return Promise.reject(e)}},updateInSet:function(e,t){try{return Promise.resolve(r(t,a,f)).then(function(r){return Promise.resolve(new Promise(function(t,n){return v.get(e).put(r,function(e){return e.err?n(e.err):t()})})).then(function(){h({type:"update",data:Object.assign({},{nodeID:e},t)})})})}catch(e){return Promise.reject(e)}},removeFromSet:function(e){try{return Promise.resolve(new Promise(function(r,t){return v.get(e).put(null,function(e){return e.err?t(e.err):r()})})).then(function(){})}catch(e){return Promise.reject(e)}}}};
//# sourceMappingURL=index.js.map
