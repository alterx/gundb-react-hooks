var e=require("react");function r(){return(r=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}var t=function(e,r,t){try{return Promise.resolve(r&&t?t.encrypt(e,r):e)}catch(e){return Promise.reject(e)}},n=function(e,r,t){try{return Promise.resolve(r&&t?t.decrypt(e,r):e)}catch(e){return Promise.reject(e)}},u=function(e,r){void 0===r&&(r=100);var t,n=[];return function(u){return n.push(u),t||(t=setTimeout(function(){var r=n.reduce(function(e,r){return e[r.id]=r.data,e},{});e(r),n=[],t=null},r)),function(){clearTimeout(t),n=[],t=null}}},o=function(e,t){var n,u=t.data;switch(t.type){case"add":return r({},e,u);case"update":return r({},e,((n={})[u.nodeID]=u,n));case"remove":return delete e[u],r({},e);default:throw new Error}},c=function(){var r=e.useRef(!1);return e.useEffect(function(){return r.current=!0,function(){return r.current=!1}},[]),r},i=function(r,t){var n=e.useReducer(r,t),u=n[0],o=n[1],i=c();return[u,function(e){i.current&&o(e)}]},s=function(r){var t=e.useState(null),n=t[0];return n||(0,t[1])(r.user()),[n]};exports.debouncedUpdates=u,exports.decryptData=n,exports.encryptData=t,exports.reducer=o,exports.useGun=function(r,t){return[e.useState(r({peers:t}))[0]]},exports.useGunCollectionState=function(s,a){void 0===a&&(a={appKeys:"",sea:null,interval:100,useOpen:!1});var f=a.appKeys,p=a.sea,l=a.interval,v=void 0===l?100:l,d=a.useOpen,h=e.useState(s)[0],m=i(o,{}),P=m[0],y=m[1],w=e.useRef(null),j=c();return e.useEffect(function(){var e=[];if(j.current){var t=u(function(e){y({type:"add",data:e})},v),o=function(u,o,c,i){try{return Promise.resolve(n(u,f,p)).then(function(n){if(n){var u=t({id:o,data:r({},n,{nodeID:o})});e.push(u)}w.current||(w.current=i)})}catch(e){return Promise.reject(e)}};if(d){if(!h.open)throw new Error("Please include gun/lib/open.");h.map().open(o)}else h.map().on(o)}return function(){w.current&&w.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),{collection:P,addToSet:function(e,r){try{return Promise.resolve(t(e,f,p)).then(function(e){var t=r?Promise.resolve(new Promise(function(t,n){return h.get(r).put(e,function(e){return e.err?n(e.err):t()})})).then(function(){}):Promise.resolve(new Promise(function(r,t){return h.set(e,function(e){return e.err?t(e.err):r()})})).then(function(){});if(t&&t.then)return t.then(function(){})})}catch(e){return Promise.reject(e)}},updateInSet:function(e,n){try{return Promise.resolve(t(n,f,p)).then(function(t){return Promise.resolve(new Promise(function(r,n){return h.get(e).put(t,function(e){return e.err?n(e.err):r()})})).then(function(){y({type:"update",data:r({nodeID:e},n)})})})}catch(e){return Promise.reject(e)}},removeFromSet:function(e){try{return Promise.resolve(new Promise(function(r,t){return h.get(e).put(null,function(e){return e.err?t(e.err):r()})})).then(function(){})}catch(e){return Promise.reject(e)}}}},exports.useGunKeyAuth=function(r,t,n){void 0===n&&(n=!0);var u=s(r)[0],o=e.useState(!1),c=o[0],i=o[1];return r.on("auth",function(){i(!0)}),e.useEffect(function(){u&&!u.is&&t&&n&&u.auth(t)},[n,u,t]),[u,c]},exports.useGunKeys=function(r,t){var n=e.useState(t),u=n[0],o=n[1];return u||function(){try{Promise.resolve(r.pair()).then(function(e){o(e)})}catch(e){return Promise.reject(e)}}(),[u,o]},exports.useGunNamespace=s,exports.useGunState=function(r,s){void 0===s&&(s={appKeys:"",sea:null,interval:100,useOpen:!1});var a=s.appKeys,f=s.sea,p=s.interval,l=void 0===p?100:p,v=s.useOpen,d=void 0!==v&&v,h=e.useState(r)[0],m=i(o,{}),P=m[0],y=m[1],w=e.useRef(null),j=c();return e.useEffect(function(){var e=[];if(j.current){var r=u(function(e){y({type:"add",data:e})},l),t=function(t,u,o,c){try{return Promise.resolve(n(t,a,f)).then(function(t){Object.keys(t).forEach(function(n){var u=r({id:n,data:t[n]});e.push(u)}),w.current||(w.current=c)})}catch(e){return Promise.reject(e)}};if(d){if(!h.open)throw new Error("Please include gun/lib/open.");h.open(t)}else h.on(t)}return function(){w.current&&w.current.off(),e.length&&e.forEach(function(e){return e()})}},[]),{fields:P,put:function(e){try{return Promise.resolve(t(e,a,f)).then(function(e){return Promise.resolve(new Promise(function(r,t){return h.put(e,function(e){return e.err?t(e.err):r()})})).then(function(){})})}catch(e){return Promise.reject(e)}},remove:function(e){try{return Promise.resolve(new Promise(function(e,r){return h.put(null,function(t){return t.err?r(t.err):e()})})).then(function(){y({type:"remove",data:e})})}catch(e){return Promise.reject(e)}}}},exports.useIsMounted=c,exports.useSafeReducer=i;
//# sourceMappingURL=index.js.map
